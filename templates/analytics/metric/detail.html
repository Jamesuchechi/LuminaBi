{% extends 'base.html' %}

{% block title %}{{ metric.name }} - LuminaBI{% endblock %}

{% block content %}
<div class="min-h-screen py-12">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Back Navigation -->
        <div class="mb-8">
            <a href="{% url 'analytics:metric_list' %}" class="inline-flex items-center gap-2 text-neonBlue hover:text-neonPurple transition group">
                <i class="fas fa-arrow-left group-hover:-translate-x-1 transition"></i>
                <span class="font-mono text-sm">Back to Metrics</span>
            </a>
        </div>

        <!-- Main Card -->
        <div class="glass-panel rounded-2xl p-8 border border-white/10">
            <!-- Header -->
            <div class="flex items-start justify-between mb-6 pb-6 border-b border-white/10 gap-4">
                <div class="flex-1">
                    <h1 class="text-4xl font-bold text-white mb-4">{{ metric.name }}</h1>
                    {% if metric.is_on_target %}
                    <span class="inline-flex items-center gap-2 px-3 py-1 bg-success/20 text-success border border-success/50 text-xs rounded-lg font-mono">
                        <i class="fas fa-check-circle"></i>On Target
                    </span>
                    {% else %}
                    <span class="inline-flex items-center gap-2 px-3 py-1 bg-error/20 text-error border border-error/50 text-xs rounded-lg font-mono">
                        <i class="fas fa-times-circle"></i>Off Target
                    </span>
                    {% endif %}
                </div>
                <div class="text-right flex-shrink-0">
                    <p class="text-4xl font-bold text-neonBlue">{{ metric.current_value }}</p>
                    <p class="text-gray-400 font-mono text-sm mt-2">{{ metric.unit }}</p>
                </div>
            </div>

            <!-- Description -->
            {% if metric.description %}
            <div class="mb-8 pb-8 border-b border-white/10">
                <p class="text-gray-300">{{ metric.description }}</p>
            </div>
            {% endif %}

            <!-- Metrics Details Grid -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 pb-8 border-b border-white/10">
                <div class="glass-panel rounded-xl p-6 border border-neonBlue/20">
                    <h3 class="text-sm font-mono uppercase tracking-wider text-gray-500 mb-3">Current Value</h3>
                    <p class="text-3xl font-bold text-neonBlue">{{ metric.current_value }}</p>
                </div>
                <div class="glass-panel rounded-xl p-6 border border-neonPurple/20">
                    <h3 class="text-sm font-mono uppercase tracking-wider text-gray-500 mb-3">Target Value</h3>
                    <p class="text-3xl font-bold text-neonPurple">{{ metric.target_value }}</p>
                </div>
                <div class="glass-panel rounded-xl p-6 {% if metric.change_percentage >= 0 %}border border-success/20{% else %}border border-error/20{% endif %}">
                    <h3 class="text-sm font-mono uppercase tracking-wider text-gray-500 mb-3">Change</h3>
                    <p class="text-3xl font-bold {% if metric.change_percentage >= 0 %}text-success{% else %}text-error{% endif %}">
                        {% if metric.change_percentage >= 0 %}<i class="fas fa-arrow-up mr-2"></i>{% else %}<i class="fas fa-arrow-down mr-2"></i>{% endif %}{{ metric.change_percentage }}%
                    </p>
                </div>
            </div>

            <!-- Thresholds -->
            <div class="mb-8 pb-8 border-b border-white/10">
                <h2 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-sliders-h text-warning"></i>
                    Thresholds
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="glass-panel p-4 rounded-xl border border-warning/20">
                        <p class="text-sm text-gray-500 font-mono uppercase">Warning Threshold</p>
                        <p class="text-2xl font-bold text-warning mt-2">{{ metric.threshold }}</p>
                    </div>
                    <div class="glass-panel p-4 rounded-xl border border-white/10">
                        <p class="text-sm text-gray-500 font-mono uppercase">Previous Value</p>
                        <p class="text-2xl font-bold text-white mt-2">{{ metric.previous_value }}</p>
                    </div>
                </div>
            </div>

            <!-- Status -->
            <div>
                <h2 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-heartbeat text-neonBlue"></i>
                    Status
                </h2>
                <div class="glass-panel p-6 rounded-xl {% if metric.status == 'normal' %}border border-success/30 bg-success/5{% elif metric.status == 'warning' %}border border-warning/30 bg-warning/5{% else %}border border-error/30 bg-error/5{% endif %}">
                    {% if metric.status == 'normal' %}
                    <p class="text-success font-semibold flex items-center gap-2">
                        <i class="fas fa-check-circle"></i>
                        Metric is performing normally
                    </p>
                    {% elif metric.status == 'warning' %}
                    <p class="text-warning font-semibold flex items-center gap-2">
                        <i class="fas fa-exclamation-circle"></i>
                        Metric is approaching threshold
                    </p>
                    {% else %}
                    <p class="text-error font-semibold flex items-center gap-2">
                        <i class="fas fa-times-circle"></i>
                        Metric has exceeded critical threshold
                    </p>
                    {% endif %}
                </div>
            </div>

            <!-- Metadata -->
            <div class="mt-8 pt-8 border-t border-white/10 text-sm text-gray-500 space-y-1 font-mono">
                <p>Dataset: <span class="text-gray-300">{{ metric.dataset.name }}</span></p>
                <p>Last Updated: <span class="text-gray-300">{{ metric.updated_at|date:"M d, Y H:i" }}</span></p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
